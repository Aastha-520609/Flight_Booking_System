package com.flightsearch.search_service.Service;

import com.flightsearch.search_service.Entity.Flight;
import com.flightsearch.search_service.Repository.SearchRepository;
import org.springframework.stereotype.Service;
import java.util.List;
import java.util.Optional;

@Service
public class SearchService {
    
    private final SearchRepository searchRepository;

    public SearchService(SearchRepository searchRepository) {
        this.searchRepository = searchRepository;
    }

    // Search flights based on source and destination
    public List<Flight> searchFlights(String source, String destination) {
        return searchRepository.findBySourceAndDestination(source, destination);
    }

    // Get flight details by flight number
    public Optional<Flight> getFlightDetails(String flightNumber) {
        return Optional.ofNullable(searchRepository.findByFlightNumber(flightNumber));
    }

    // Check flight availability by flight ID and required seats
    public boolean checkFlightAvailability(Integer flightId, int requiredSeats) {
        return searchRepository.existsByFlightIdAndSeatsAvailableGreaterThan(flightId, requiredSeats);
    }
}
