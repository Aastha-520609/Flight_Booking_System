package com.flightsearch.search_service.Controller;

import com.flightsearch.search_service.Entity.Flight;
import com.flightsearch.search_service.Service.SearchService;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/flights")
public class SearchController {

    private final SearchService searchService;

    public SearchController(SearchService searchService) {
        this.searchService = searchService;
    }

    // Search flights by source and destination
    @GetMapping("/search")
    public ResponseEntity<List<Flight>> findFlightsBySourceAndDestination(@RequestParam String source, @RequestParam String destination) {
        List<Flight> flights = searchService.searchFlights(source, destination);
        return ResponseEntity.ok(flights);
    }

 // Get flight details by flight number
    @GetMapping("/{flightNumber}")
    public ResponseEntity<Optional<Flight>> getFlightDetails(@PathVariable String flightNumber) {
        Optional<Flight> flight = searchService.getFlightDetails(flightNumber);
        return ResponseEntity.ok(flight);
    }

    // Check flight seat availability
    @GetMapping("/{flightId}/availability")
    public ResponseEntity<Boolean> isFlightAvailable(@PathVariable Integer flightId, @RequestParam int requiredSeats) {
        boolean available = searchService.checkFlightAvailability(flightId, requiredSeats);
        return ResponseEntity.ok(available);
    }
}
